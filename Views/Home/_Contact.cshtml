@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

<div id="contact" class="container py-5">
  <h2 class="text-center mb-4">@Localizer["ContactTitle"]</h2>
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="p-4 rounded-4 shadow-sm bg-white">
        <form id="contactForm" asp-controller="Contact" asp-action="SendEmail" method="post">
          <div class="mb-3">
            <label for="nombre" class="form-label">@Localizer["ContactNameLabel"]</label>
            <input type="text" class="form-control" id="nombre" name="Nombre" required>
          </div>
          <div class="mb-3">
            <label for="email" class="form-label">@Localizer["ContactEmailLabel"]</label>
            <input type="email" class="form-control" id="email" name="Email" required>
          </div>
          <div class="mb-3">
            <label for="mensaje" class="form-label">@Localizer["ContactMessageLabel"]</label>
            <textarea class="form-control" id="mensaje" name="Mensaje" rows="5" required></textarea>
          </div>
          <div class="text-center">
            <button type="submit" id="submitBtn" class="btn btn-primary px-4">@Localizer["ContactButton"]</button>
          </div>
          <div id="formMessage" class="mt-3 text-center"></div>
        </form>

      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById("contactForm").addEventListener("submit", function (e) {
      e.preventDefault();

      let form = this;
      let btn = document.getElementById("submitBtn");
      let msgDiv = document.getElementById("formMessage");

      btn.disabled = true;

      let formData = new FormData(form);

      fetch(form.action, {
          method: "POST",
          body: formData
      })
      .then(res => res.json())
      .then(data => {
          if (data.success) {
              msgDiv.innerHTML = `<div class="alert alert-success">${data.message}</div>`;
              form.reset();
          } else {
              msgDiv.innerHTML = `<div class="alert alert-danger">${data.message}</div>`;
          }

          // Reactivar botón después de 5 segundos
          setTimeout(() => {
              btn.disabled = false;
          }, 5000);
      })
      .catch(err => {
          msgDiv.innerHTML = `<div class="alert alert-danger">Unexpected error</div>`;
          btn.disabled = false;
      });
  });
</script>